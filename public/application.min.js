!function(t){t&&(t.fn.headroom=function(n){return this.each(function(){var r=t(this),e=r.data("headroom"),i="object"==typeof n&&n;i=t.extend(!0,{},Headroom.options,i),e||(e=new Headroom(this,i),e.init(),r.data("headroom",e)),"string"==typeof n&&e[n]()})},t("[data-headroom]").each(function(){var n=t(this);n.headroom(n.data())}))}(window.Zepto||window.jQuery),/*!
 * headroom.js v0.7.0 - Give your page some headroom. Hide your header until you need it
 * Copyright (c) 2014 Nick Williams - http://wicky.nillia.ms/headroom.js
 * License: MIT
 */
!function(t,n){"use strict";function r(t){this.callback=t,this.ticking=!1}function e(n){return n&&"undefined"!=typeof t&&(n===t||n.nodeType)}function i(t){if(arguments.length<=0)throw new Error("Missing arguments in extend function");var n,r,u=t||{};for(r=1;r<arguments.length;r++){var o=arguments[r]||{};for(n in o)u[n]="object"!=typeof u[n]||e(u[n])?u[n]||o[n]:i(u[n],o[n])}return u}function u(t){return t===Object(t)?t:{down:t,up:t}}function o(t,n){n=i(n,o.options),this.lastKnownScrollY=0,this.elem=t,this.debouncer=new r(this.update.bind(this)),this.tolerance=u(n.tolerance),this.classes=n.classes,this.offset=n.offset,this.scroller=n.scroller,this.initialised=!1,this.onPin=n.onPin,this.onUnpin=n.onUnpin,this.onTop=n.onTop,this.onNotTop=n.onNotTop}var s={bind:!!function(){}.bind,classList:"classList"in n.documentElement,rAF:!!(t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame)};t.requestAnimationFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame,r.prototype={constructor:r,update:function(){this.callback&&this.callback(),this.ticking=!1},requestTick:function(){this.ticking||(requestAnimationFrame(this.rafCallback||(this.rafCallback=this.update.bind(this))),this.ticking=!0)},handleEvent:function(){this.requestTick()}},o.prototype={constructor:o,init:function(){return o.cutsTheMustard?(this.elem.classList.add(this.classes.initial),setTimeout(this.attachEvent.bind(this),100),this):void 0},destroy:function(){var t=this.classes;this.initialised=!1,this.elem.classList.remove(t.unpinned,t.pinned,t.top,t.initial),this.scroller.removeEventListener("scroll",this.debouncer,!1)},attachEvent:function(){this.initialised||(this.lastKnownScrollY=this.getScrollY(),this.initialised=!0,this.scroller.addEventListener("scroll",this.debouncer,!1),this.debouncer.handleEvent())},unpin:function(){var t=this.elem.classList,n=this.classes;(t.contains(n.pinned)||!t.contains(n.unpinned))&&(t.add(n.unpinned),t.remove(n.pinned),this.onUnpin&&this.onUnpin.call(this))},pin:function(){var t=this.elem.classList,n=this.classes;t.contains(n.unpinned)&&(t.remove(n.unpinned),t.add(n.pinned),this.onPin&&this.onPin.call(this))},top:function(){var t=this.elem.classList,n=this.classes;t.contains(n.top)||(t.add(n.top),t.remove(n.notTop),this.onTop&&this.onTop.call(this))},notTop:function(){var t=this.elem.classList,n=this.classes;t.contains(n.notTop)||(t.add(n.notTop),t.remove(n.top),this.onNotTop&&this.onNotTop.call(this))},getScrollY:function(){return void 0!==this.scroller.pageYOffset?this.scroller.pageYOffset:void 0!==this.scroller.scrollTop?this.scroller.scrollTop:(n.documentElement||n.body.parentNode||n.body).scrollTop},getViewportHeight:function(){return t.innerHeight||n.documentElement.clientHeight||n.body.clientHeight},getDocumentHeight:function(){var t=n.body,r=n.documentElement;return Math.max(t.scrollHeight,r.scrollHeight,t.offsetHeight,r.offsetHeight,t.clientHeight,r.clientHeight)},getElementHeight:function(t){return Math.max(t.scrollHeight,t.offsetHeight,t.clientHeight)},getScrollerHeight:function(){return this.scroller===t||this.scroller===n.body?this.getDocumentHeight():this.getElementHeight(this.scroller)},isOutOfBounds:function(t){var n=0>t,r=t+this.getViewportHeight()>this.getScrollerHeight();return n||r},toleranceExceeded:function(t,n){return Math.abs(t-this.lastKnownScrollY)>=this.tolerance[n]},shouldUnpin:function(t,n){var r=t>this.lastKnownScrollY,e=t>=this.offset;return r&&e&&n},shouldPin:function(t,n){var r=t<this.lastKnownScrollY,e=t<=this.offset;return r&&n||e},update:function(){var t=this.getScrollY(),n=t>this.lastKnownScrollY?"down":"up",r=this.toleranceExceeded(t,n);this.isOutOfBounds(t)||(t<=this.offset?this.top():this.notTop(),this.shouldUnpin(t,r)?this.unpin():this.shouldPin(t,r)&&this.pin(),this.lastKnownScrollY=t)}},o.options={tolerance:{up:0,down:0},offset:0,scroller:t,classes:{pinned:"headroom--pinned",unpinned:"headroom--unpinned",top:"headroom--top",notTop:"headroom--not-top",initial:"headroom"}},o.cutsTheMustard="undefined"!=typeof s&&s.rAF&&s.bind&&s.classList,t.Headroom=o}(window,document),function(t){function n(t,n){return"function"==typeof t?t.call(n):t}function r(t){for(;t=t.parentNode;)if(t==document)return!0;return!1}function e(n,r){this.$element=t(n),this.options=r,this.enabled=!0,this.fixTitle()}e.prototype={show:function(){var r=this.getTitle();if(r&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](r),e[0].className="tipsy",e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var i,u=t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),o=e[0].offsetWidth,s=e[0].offsetHeight,a=n(this.options.gravity,this.$element[0]);switch(a.charAt(0)){case"n":i={top:u.top+u.height+this.options.offset,left:u.left+u.width/2-o/2};break;case"s":i={top:u.top-s-this.options.offset,left:u.left+u.width/2-o/2};break;case"e":i={top:u.top+u.height/2-s/2,left:u.left-o-this.options.offset};break;case"w":i={top:u.top+u.height/2-s/2,left:u.left+u.width+this.options.offset}}2==a.length&&(i.left="w"==a.charAt(1)?u.left+u.width/2-15:u.left+u.width/2-o+15),e.css(i).addClass("tipsy-"+a),e.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+a.charAt(0),this.options.className&&e.addClass(n(this.options.className,this.$element[0])),this.options.fade?e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):e.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){t(this).remove()}):this.tip().remove()},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("original-title"))&&t.attr("original-title",t.attr("title")||"").removeAttr("title")},getTitle:function(){var t,n=this.$element,r=this.options;this.fixTitle();var t,r=this.options;return"string"==typeof r.title?t=n.attr("title"==r.title?"original-title":r.title):"function"==typeof r.title&&(t=r.title.call(n[0])),t=(""+t).replace(/(^\s*|\s*$)/,""),t||r.fallback},tip:function(){return this.$tip||(this.$tip=t('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},t.fn.tipsy=function(n){function r(r){var i=t.data(r,"tipsy");return i||(i=new e(r,t.fn.tipsy.elementOptions(r,n)),t.data(r,"tipsy",i)),i}function i(){var t=r(this);t.hoverState="in",0==n.delayIn?t.show():(t.fixTitle(),setTimeout(function(){"in"==t.hoverState&&t.show()},n.delayIn))}function u(){var t=r(this);t.hoverState="out",0==n.delayOut?t.hide():setTimeout(function(){"out"==t.hoverState&&t.hide()},n.delayOut)}if(n===!0)return this.data("tipsy");if("string"==typeof n){var o=this.data("tipsy");return o&&o[n](),this}if(n=t.extend({},t.fn.tipsy.defaults,n),n.live||this.each(function(){r(this)}),"manual"!=n.trigger){var s=n.live?"live":"bind",a="hover"==n.trigger?"mouseenter":"focus",c="hover"==n.trigger?"mouseleave":"blur";this[s](a,i)[s](c,u)}return this},t.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},t.fn.tipsy.revalidate=function(){t(".tipsy").each(function(){var n=t.data(this,"tipsy-pointee");n&&r(n)||t(this).remove()})},t.fn.tipsy.elementOptions=function(n,r){return t.metadata?t.extend({},r,t(n).metadata()):r},t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"},t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"},t.fn.tipsy.autoBounds=function(n,r){return function(){var e={ns:r[0],ew:r.length>1?r[1]:!1},i=t(document).scrollTop()+n,u=t(document).scrollLeft()+n,o=t(this);return o.offset().top<i&&(e.ns="n"),o.offset().left<u&&(e.ew="w"),t(window).width()+t(document).scrollLeft()-o.offset().left<n&&(e.ew="e"),t(window).height()+t(document).scrollTop()-o.offset().top<n&&(e.ns="s"),e.ns+(e.ew?e.ew:"")}}}(jQuery),function(){var t=this,n=t._,r=Array.prototype,e=Object.prototype,i=Function.prototype,u=r.push,o=r.slice,s=r.concat,a=e.toString,c=e.hasOwnProperty,l=Array.isArray,f=Object.keys,h=i.bind,p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):t._=p,p.VERSION="1.7.0";var d=function(t,n,r){if(void 0===n)return t;switch(null==r?3:r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)};case 4:return function(r,e,i,u){return t.call(n,r,e,i,u)}}return function(){return t.apply(n,arguments)}};p.iteratee=function(t,n,r){return null==t?p.identity:p.isFunction(t)?d(t,n,r):p.isObject(t)?p.matches(t):p.property(t)},p.each=p.forEach=function(t,n,r){if(null==t)return t;n=d(n,r);var e,i=t.length;if(i===+i)for(e=0;i>e;e++)n(t[e],e,t);else{var u=p.keys(t);for(e=0,i=u.length;i>e;e++)n(t[u[e]],u[e],t)}return t},p.map=p.collect=function(t,n,r){if(null==t)return[];n=p.iteratee(n,r);for(var e,i=t.length!==+t.length&&p.keys(t),u=(i||t).length,o=Array(u),s=0;u>s;s++)e=i?i[s]:s,o[s]=n(t[e],e,t);return o};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(t,n,r,e){null==t&&(t=[]),n=d(n,e,4);var i,u=t.length!==+t.length&&p.keys(t),o=(u||t).length,s=0;if(arguments.length<3){if(!o)throw new TypeError(g);r=t[u?u[s++]:s++]}for(;o>s;s++)i=u?u[s]:s,r=n(r,t[i],i,t);return r},p.reduceRight=p.foldr=function(t,n,r,e){null==t&&(t=[]),n=d(n,e,4);var i,u=t.length!==+t.length&&p.keys(t),o=(u||t).length;if(arguments.length<3){if(!o)throw new TypeError(g);r=t[u?u[--o]:--o]}for(;o--;)i=u?u[o]:o,r=n(r,t[i],i,t);return r},p.find=p.detect=function(t,n,r){var e;return n=p.iteratee(n,r),p.some(t,function(t,r,i){return n(t,r,i)?(e=t,!0):void 0}),e},p.filter=p.select=function(t,n,r){var e=[];return null==t?e:(n=p.iteratee(n,r),p.each(t,function(t,r,i){n(t,r,i)&&e.push(t)}),e)},p.reject=function(t,n,r){return p.filter(t,p.negate(p.iteratee(n)),r)},p.every=p.all=function(t,n,r){if(null==t)return!0;n=p.iteratee(n,r);var e,i,u=t.length!==+t.length&&p.keys(t),o=(u||t).length;for(e=0;o>e;e++)if(i=u?u[e]:e,!n(t[i],i,t))return!1;return!0},p.some=p.any=function(t,n,r){if(null==t)return!1;n=p.iteratee(n,r);var e,i,u=t.length!==+t.length&&p.keys(t),o=(u||t).length;for(e=0;o>e;e++)if(i=u?u[e]:e,n(t[i],i,t))return!0;return!1},p.contains=p.include=function(t,n){return null==t?!1:(t.length!==+t.length&&(t=p.values(t)),p.indexOf(t,n)>=0)},p.invoke=function(t,n){var r=o.call(arguments,2),e=p.isFunction(n);return p.map(t,function(t){return(e?n:t[n]).apply(t,r)})},p.pluck=function(t,n){return p.map(t,p.property(n))},p.where=function(t,n){return p.filter(t,p.matches(n))},p.findWhere=function(t,n){return p.find(t,p.matches(n))},p.max=function(t,n,r){var e,i,u=-1/0,o=-1/0;if(null==n&&null!=t){t=t.length===+t.length?t:p.values(t);for(var s=0,a=t.length;a>s;s++)e=t[s],e>u&&(u=e)}else n=p.iteratee(n,r),p.each(t,function(t,r,e){i=n(t,r,e),(i>o||i===-1/0&&u===-1/0)&&(u=t,o=i)});return u},p.min=function(t,n,r){var e,i,u=1/0,o=1/0;if(null==n&&null!=t){t=t.length===+t.length?t:p.values(t);for(var s=0,a=t.length;a>s;s++)e=t[s],u>e&&(u=e)}else n=p.iteratee(n,r),p.each(t,function(t,r,e){i=n(t,r,e),(o>i||1/0===i&&1/0===u)&&(u=t,o=i)});return u},p.shuffle=function(t){for(var n,r=t&&t.length===+t.length?t:p.values(t),e=r.length,i=Array(e),u=0;e>u;u++)n=p.random(0,u),n!==u&&(i[u]=i[n]),i[n]=r[u];return i},p.sample=function(t,n,r){return null==n||r?(t.length!==+t.length&&(t=p.values(t)),t[p.random(t.length-1)]):p.shuffle(t).slice(0,Math.max(0,n))},p.sortBy=function(t,n,r){return n=p.iteratee(n,r),p.pluck(p.map(t,function(t,r,e){return{value:t,index:r,criteria:n(t,r,e)}}).sort(function(t,n){var r=t.criteria,e=n.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return t.index-n.index}),"value")};var m=function(t){return function(n,r,e){var i={};return r=p.iteratee(r,e),p.each(n,function(e,u){var o=r(e,u,n);t(i,e,o)}),i}};p.groupBy=m(function(t,n,r){p.has(t,r)?t[r].push(n):t[r]=[n]}),p.indexBy=m(function(t,n,r){t[r]=n}),p.countBy=m(function(t,n,r){p.has(t,r)?t[r]++:t[r]=1}),p.sortedIndex=function(t,n,r,e){r=p.iteratee(r,e,1);for(var i=r(n),u=0,o=t.length;o>u;){var s=u+o>>>1;r(t[s])<i?u=s+1:o=s}return u},p.toArray=function(t){return t?p.isArray(t)?o.call(t):t.length===+t.length?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:t.length===+t.length?t.length:p.keys(t).length},p.partition=function(t,n,r){n=p.iteratee(n,r);var e=[],i=[];return p.each(t,function(t,r,u){(n(t,r,u)?e:i).push(t)}),[e,i]},p.first=p.head=p.take=function(t,n,r){return null==t?void 0:null==n||r?t[0]:0>n?[]:o.call(t,0,n)},p.initial=function(t,n,r){return o.call(t,0,Math.max(0,t.length-(null==n||r?1:n)))},p.last=function(t,n,r){return null==t?void 0:null==n||r?t[t.length-1]:o.call(t,Math.max(t.length-n,0))},p.rest=p.tail=p.drop=function(t,n,r){return o.call(t,null==n||r?1:n)},p.compact=function(t){return p.filter(t,p.identity)};var v=function(t,n,r,e){if(n&&p.every(t,p.isArray))return s.apply(e,t);for(var i=0,o=t.length;o>i;i++){var a=t[i];p.isArray(a)||p.isArguments(a)?n?u.apply(e,a):v(a,n,r,e):r||e.push(a)}return e};p.flatten=function(t,n){return v(t,n,!1,[])},p.without=function(t){return p.difference(t,o.call(arguments,1))},p.uniq=p.unique=function(t,n,r,e){if(null==t)return[];p.isBoolean(n)||(e=r,r=n,n=!1),null!=r&&(r=p.iteratee(r,e));for(var i=[],u=[],o=0,s=t.length;s>o;o++){var a=t[o];if(n)o&&u===a||i.push(a),u=a;else if(r){var c=r(a,o,t);p.indexOf(u,c)<0&&(u.push(c),i.push(a))}else p.indexOf(i,a)<0&&i.push(a)}return i},p.union=function(){return p.uniq(v(arguments,!0,!0,[]))},p.intersection=function(t){if(null==t)return[];for(var n=[],r=arguments.length,e=0,i=t.length;i>e;e++){var u=t[e];if(!p.contains(n,u)){for(var o=1;r>o&&p.contains(arguments[o],u);o++);o===r&&n.push(u)}}return n},p.difference=function(t){var n=v(o.call(arguments,1),!0,!0,[]);return p.filter(t,function(t){return!p.contains(n,t)})},p.zip=function(t){if(null==t)return[];for(var n=p.max(arguments,"length").length,r=Array(n),e=0;n>e;e++)r[e]=p.pluck(arguments,e);return r},p.object=function(t,n){if(null==t)return{};for(var r={},e=0,i=t.length;i>e;e++)n?r[t[e]]=n[e]:r[t[e][0]]=t[e][1];return r},p.indexOf=function(t,n,r){if(null==t)return-1;var e=0,i=t.length;if(r){if("number"!=typeof r)return e=p.sortedIndex(t,n),t[e]===n?e:-1;e=0>r?Math.max(0,i+r):r}for(;i>e;e++)if(t[e]===n)return e;return-1},p.lastIndexOf=function(t,n,r){if(null==t)return-1;var e=t.length;for("number"==typeof r&&(e=0>r?e+r+1:Math.min(e,r+1));--e>=0;)if(t[e]===n)return e;return-1},p.range=function(t,n,r){arguments.length<=1&&(n=t||0,t=0),r=r||1;for(var e=Math.max(Math.ceil((n-t)/r),0),i=Array(e),u=0;e>u;u++,t+=r)i[u]=t;return i};var y=function(){};p.bind=function(t,n){var r,e;if(h&&t.bind===h)return h.apply(t,o.call(arguments,1));if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return t.apply(n,r.concat(o.call(arguments)));y.prototype=t.prototype;var i=new y;y.prototype=null;var u=t.apply(i,r.concat(o.call(arguments)));return p.isObject(u)?u:i}},p.partial=function(t){var n=o.call(arguments,1);return function(){for(var r=0,e=n.slice(),i=0,u=e.length;u>i;i++)e[i]===p&&(e[i]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return t.apply(this,e)}},p.bindAll=function(t){var n,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(n=1;e>n;n++)r=arguments[n],t[r]=p.bind(t[r],t);return t},p.memoize=function(t,n){var r=function(e){var i=r.cache,u=n?n.apply(this,arguments):e;return p.has(i,u)||(i[u]=t.apply(this,arguments)),i[u]};return r.cache={},r},p.delay=function(t,n){var r=o.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},n)},p.defer=function(t){return p.delay.apply(p,[t,1].concat(o.call(arguments,1)))},p.throttle=function(t,n,r){var e,i,u,o=null,s=0;r||(r={});var a=function(){s=r.leading===!1?0:p.now(),o=null,u=t.apply(e,i),o||(e=i=null)};return function(){var c=p.now();s||r.leading!==!1||(s=c);var l=n-(c-s);return e=this,i=arguments,0>=l||l>n?(clearTimeout(o),o=null,s=c,u=t.apply(e,i),o||(e=i=null)):o||r.trailing===!1||(o=setTimeout(a,l)),u}},p.debounce=function(t,n,r){var e,i,u,o,s,a=function(){var c=p.now()-o;n>c&&c>0?e=setTimeout(a,n-c):(e=null,r||(s=t.apply(u,i),e||(u=i=null)))};return function(){u=this,i=arguments,o=p.now();var c=r&&!e;return e||(e=setTimeout(a,n)),c&&(s=t.apply(u,i),u=i=null),s}},p.wrap=function(t,n){return p.partial(n,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var t=arguments,n=t.length-1;return function(){for(var r=n,e=t[n].apply(this,arguments);r--;)e=t[r].call(this,e);return e}},p.after=function(t,n){return function(){return--t<1?n.apply(this,arguments):void 0}},p.before=function(t,n){var r;return function(){return--t>0?r=n.apply(this,arguments):n=null,r}},p.once=p.partial(p.before,2),p.keys=function(t){if(!p.isObject(t))return[];if(f)return f(t);var n=[];for(var r in t)p.has(t,r)&&n.push(r);return n},p.values=function(t){for(var n=p.keys(t),r=n.length,e=Array(r),i=0;r>i;i++)e[i]=t[n[i]];return e},p.pairs=function(t){for(var n=p.keys(t),r=n.length,e=Array(r),i=0;r>i;i++)e[i]=[n[i],t[n[i]]];return e},p.invert=function(t){for(var n={},r=p.keys(t),e=0,i=r.length;i>e;e++)n[t[r[e]]]=r[e];return n},p.functions=p.methods=function(t){var n=[];for(var r in t)p.isFunction(t[r])&&n.push(r);return n.sort()},p.extend=function(t){if(!p.isObject(t))return t;for(var n,r,e=1,i=arguments.length;i>e;e++){n=arguments[e];for(r in n)c.call(n,r)&&(t[r]=n[r])}return t},p.pick=function(t,n,r){var e,i={};if(null==t)return i;if(p.isFunction(n)){n=d(n,r);for(e in t){var u=t[e];n(u,e,t)&&(i[e]=u)}}else{var a=s.apply([],o.call(arguments,1));t=new Object(t);for(var c=0,l=a.length;l>c;c++)e=a[c],e in t&&(i[e]=t[e])}return i},p.omit=function(t,n,r){if(p.isFunction(n))n=p.negate(n);else{var e=p.map(s.apply([],o.call(arguments,1)),String);n=function(t,n){return!p.contains(e,n)}}return p.pick(t,n,r)},p.defaults=function(t){if(!p.isObject(t))return t;for(var n=1,r=arguments.length;r>n;n++){var e=arguments[n];for(var i in e)void 0===t[i]&&(t[i]=e[i])}return t},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,n){return n(t),t};var b=function(t,n,r,e){if(t===n)return 0!==t||1/t===1/n;if(null==t||null==n)return t===n;t instanceof p&&(t=t._wrapped),n instanceof p&&(n=n._wrapped);var i=a.call(t);if(i!==a.call(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!==+t?+n!==+n:0===+t?1/+t===1/n:+t===+n;case"[object Date]":case"[object Boolean]":return+t===+n}if("object"!=typeof t||"object"!=typeof n)return!1;for(var u=r.length;u--;)if(r[u]===t)return e[u]===n;var o=t.constructor,s=n.constructor;if(o!==s&&"constructor"in t&&"constructor"in n&&!(p.isFunction(o)&&o instanceof o&&p.isFunction(s)&&s instanceof s))return!1;r.push(t),e.push(n);var c,l;if("[object Array]"===i){if(c=t.length,l=c===n.length)for(;c--&&(l=b(t[c],n[c],r,e)););}else{var f,h=p.keys(t);if(c=h.length,l=p.keys(n).length===c)for(;c--&&(f=h[c],l=p.has(n,f)&&b(t[f],n[f],r,e)););}return r.pop(),e.pop(),l};p.isEqual=function(t,n){return b(t,n,[],[])},p.isEmpty=function(t){if(null==t)return!0;if(p.isArray(t)||p.isString(t)||p.isArguments(t))return 0===t.length;for(var n in t)if(p.has(t,n))return!1;return!0},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=l||function(t){return"[object Array]"===a.call(t)},p.isObject=function(t){var n=typeof t;return"function"===n||"object"===n&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){p["is"+t]=function(n){return a.call(n)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")}),"function"!=typeof/./&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&t!==+t},p.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===a.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,n){return null!=t&&c.call(t,n)},p.noConflict=function(){return t._=n,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=function(t){return function(n){return n[t]}},p.matches=function(t){var n=p.pairs(t),r=n.length;return function(t){if(null==t)return!r;t=new Object(t);for(var e=0;r>e;e++){var i=n[e],u=i[0];if(i[1]!==t[u]||!(u in t))return!1}return!0}},p.times=function(t,n,r){var e=Array(Math.max(0,t));n=d(n,r,1);for(var i=0;t>i;i++)e[i]=n(i);return e},p.random=function(t,n){return null==n&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},E=p.invert(w),S=function(t){var n=function(n){return t[n]},r="(?:"+p.keys(t).join("|")+")",e=RegExp(r),i=RegExp(r,"g");return function(t){return t=null==t?"":""+t,e.test(t)?t.replace(i,n):t}};p.escape=S(w),p.unescape=S(E),p.result=function(t,n){if(null==t)return void 0;var r=t[n];return p.isFunction(r)?t[n]():r};var _=0;p.uniqueId=function(t){var n=++_+"";return t?t+n:n},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},x=/\\|'|\r|\n|\u2028|\u2029/g,T=function(t){return"\\"+k[t]};p.template=function(t,n,r){!n&&r&&(n=r),n=p.defaults({},n,p.templateSettings);var e=RegExp([(n.escape||A).source,(n.interpolate||A).source,(n.evaluate||A).source].join("|")+"|$","g"),i=0,u="__p+='";t.replace(e,function(n,r,e,o,s){return u+=t.slice(i,s).replace(x,T),i=s+n.length,r?u+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?u+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(u+="';\n"+o+"\n__p+='"),n}),u+="';\n",n.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{var o=new Function(n.variable||"obj","_",u)}catch(s){throw s.source=u,s}var a=function(t){return o.call(this,t,p)},c=n.variable||"obj";return a.source="function("+c+"){\n"+u+"}",a},p.chain=function(t){var n=p(t);return n._chain=!0,n};var M=function(t){return this._chain?p(t).chain():t};p.mixin=function(t){p.each(p.functions(t),function(n){var r=p[n]=t[n];p.prototype[n]=function(){var t=[this._wrapped];return u.apply(t,arguments),M.call(this,r.apply(p,t))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=r[t];p.prototype[t]=function(){var r=this._wrapped;return n.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0],M.call(this,r)}}),p.each(["concat","join","slice"],function(t){var n=r[t];p.prototype[t]=function(){return M.call(this,n.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}.call(this),function(){var t,n,r,e,i,u,o,s,a,c,l,f,h,p,d,g,m,v,y,b,w,E,S,_,A,k,x,T,M,O,I,j,H,W,F,B,q,N,V,C,$,L,D,P,R,U,z,Y,K,Q,Z,X,G,J,tn,nn,rn,en,un,on,sn,an,cn,ln,fn,hn,pn,dn=[].slice,gn={}.hasOwnProperty,mn=function(t,n){function r(){this.constructor=t}for(var e in n)gn.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},vn=function(t,n){return function(){return t.apply(n,arguments)}};t={toString:function(){return"Bacon"}},t.version="<version>",f=("undefined"!=typeof global&&null!==global?global:this).Error,t.fromBinder=function(n,r){return null==r&&(r=hn.id),new l(H(t,"fromBinder",n,r),function(e){var i,u,o;return o=!1,i=function(){return"undefined"!=typeof u&&null!==u?(o||u(),o=!0):void 0},u=n(function(){var n,o,s,a,l,f;for(n=1<=arguments.length?dn.call(arguments,0):[],a=r.apply(this,n),$(a)&&hn.last(a)instanceof c||(a=[a]),s=t.more,l=0,f=a.length;f>l;l++)if(o=a[l],s=e(o=un(o)),s===t.noMore||o.isEnd())return null!=u?i():t.scheduler.setTimeout(i,0),s;return s}),i})},t.$={},t.$.asEventStream=function(n,r,e){var i;return D(r)&&(i=[r,void 0],e=i[0],r=i[1]),ln(this.selector||this,"asEventStream",n,t.fromBinder(function(t){return function(e){return t.on(n,r,e),function(){return t.off(n,r,e)}}}(this),e))},null!=(pn="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:void 0)&&(pn.fn.asEventStream=t.$.asEventStream),t.fromEventTarget=function(n,r,e){var i,u,o,s,a,c,l,f;return i=null!=(o=null!=(s=null!=(a=n.addEventListener)?a:n.addListener)?s:n.bind)?o:n.on,u=null!=(c=null!=(l=null!=(f=n.removeEventListener)?f:n.removeListener)?l:n.unbind)?c:n.off,ln(t,"fromEventTarget",n,r,t.fromBinder(function(t){return i.call(n,r,t),function(){return u.call(n,r,t)}},e))},t.fromPromise=function(n,r){return ln(t,"fromPromise",n,t.fromBinder(function(t){return n.then(t,function(n){return t(new a(n))}),function(){return r&&"function"==typeof n.abort?n.abort():void 0}},function(t){return[t,W()]}))},t.noMore=["<no-more>"],t.more=["<more>"],t.later=function(n,r){return ln(t,"later",n,r,t.fromPoll(n,function(){return[r,W()]}))},t.sequentially=function(n,r){var e;return e=0,ln(t,"sequentially",n,r,t.fromPoll(n,function(){var t;return t=r[e++],e<r.length?t:e===r.length?[t,W()]:W()}))},t.repeatedly=function(n,r){var e;return e=0,ln(t,"repeatedly",n,r,t.fromPoll(n,function(){return r[e++%r.length]}))},t.spy=function(t){return rn.push(t)},rn=[],nn=function(t){var n,r,e;if(rn.length&&!nn.running)try{for(nn.running=!0,r=0,e=rn.length;e>r;r++)(n=rn[r])(t)}finally{delete nn.running}return void 0},fn=function(t){return function(){var n,r,e,i;return e=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],"object"==typeof e&&n.length&&(r=e,i=n[0],e=function(){return r[i].apply(r,arguments)},n=n.slice(1)),t.apply(null,[e].concat(dn.call(n)))}},U=function(n,r){return fn(function(){var e,i,u;return i=arguments[0],e=2<=arguments.length?dn.call(arguments,1):[],u=J(r,[function(t,n){return i.apply(null,dn.call(t).concat([n]))}]),ln.apply(null,[t,n,i].concat(dn.call(e),[t.combineAsArray(e).flatMap(u)]))})},t.fromCallback=U("fromCallback",function(){var n,r;return r=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],t.fromBinder(function(t){return z(r,n)(t),G},function(t){return[t,W()]})}),t.fromNodeCallback=U("fromNodeCallback",function(){var n,r;return r=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],t.fromBinder(function(t){return z(r,n)(t),G},function(t,n){return t?[new a(t),W()]:[n,W()]})}),t.fromPoll=function(n,r){return ln(t,"fromPoll",n,r,t.fromBinder(function(r){var e;return e=t.scheduler.setInterval(r,n),function(){return t.scheduler.clearInterval(e)}},r))},t.interval=function(n,r){return null==r&&(r={}),ln(t,"interval",n,r,t.fromPoll(n,function(){return X(r)}))},t.constant=function(n){return new m(H(t,"constant",n),function(t){return t(C(n)),t(W()),G})},t.never=function(){return new l(H(t,"never"),function(t){return t(W()),G})},t.once=function(n){return new l(H(t,"once",n),function(t){return t(un(n)),t(W()),G})},t.fromArray=function(n){var r;return _(n),r=0,new l(H(t,"fromArray",n),function(e){var i,u,o;for(u=!1,i=t.more;i!==t.noMore&&!u;)r>=n.length?(e(W()),i=t.noMore):(o=n[r++],i=e(un(o)));return function(){return u=!0}})},t.mergeAll=function(){var n;return n=1<=arguments.length?dn.call(arguments,0):[],$(n[0])&&(n=n[0]),n.length?new l(H.apply(null,[t,"mergeAll"].concat(dn.call(n))),function(r){var e,i,u;return e=0,u=function(i){return function(u){return i.dispatcher.subscribe(function(i){var o;return i.isEnd()?(e++,e===n.length?r(W()):t.more):(o=r(i),o===t.noMore&&u(),o)})}},i=hn.map(u,n),O.apply(null,i)}):t.never()},t.zipAsArray=function(){var n;return n=1<=arguments.length?dn.call(arguments,0):[],$(n[0])&&(n=n[0]),ln.apply(null,[t,"zipAsArray"].concat(dn.call(n),[t.zipWith(n,function(){var t;return t=1<=arguments.length?dn.call(arguments,0):[]})]))},t.zipWith=function(){var n,r,e;return n=arguments[0],r=2<=arguments.length?dn.call(arguments,1):[],D(n)||(e=[n,r[0]],r=e[0],n=e[1]),r=hn.map(function(t){return t.toEventStream()},r),ln.apply(null,[t,"zipWith",n].concat(dn.call(r),[t.when(r,n)]))},t.groupSimultaneous=function(){var r,e,i;return i=1<=arguments.length?dn.call(arguments,0):[],1===i.length&&$(i[0])&&(i=i[0]),e=function(){var t,e,u;for(u=[],t=0,e=i.length;e>t;t++)r=i[t],u.push(new n(r));return u}(),ln.apply(null,[t,"groupSimultaneous"].concat(dn.call(i),[t.when(e,function(){var t;return t=1<=arguments.length?dn.call(arguments,0):[]})]))},t.combineAsArray=function(){var n,r,e,i,u,o,s;for(u=1<=arguments.length?dn.call(arguments,0):[],1===u.length&&$(u[0])&&(u=u[0]),n=o=0,s=u.length;s>o;n=++o)i=u[n],P(i)||(u[n]=t.constant(i));return u.length?(e=function(){var t,n,e;for(e=[],t=0,n=u.length;n>t;t++)r=u[t],e.push(new b(r,!0));return e}(),ln.apply(null,[t,"combineAsArray"].concat(dn.call(u),[t.when(e,function(){var t;return t=1<=arguments.length?dn.call(arguments,0):[]}).toProperty()]))):t.constant([])},t.onValues=function(){var n,r,e;return r=2<=arguments.length?dn.call(arguments,0,e=arguments.length-1):(e=0,[]),n=arguments[e++],t.combineAsArray(r).onValues(n)},t.combineWith=function(){var n,r;return n=arguments[0],r=2<=arguments.length?dn.call(arguments,1):[],ln.apply(null,[t,"combineWith",n].concat(dn.call(r),[t.combineAsArray(r).map(function(t){return n.apply(null,t)})]))},t.combineTemplate=function(n){var r,e,i,u,o,s,a,c,l,f;return a=[],f=[],s=function(t){return t[t.length-1]},l=function(t,n,r){return s(t)[n]=r},r=function(t,n){return function(r,e){return l(r,t,e[n])}},o=function(t,n){return function(r){return l(r,t,n)}},c=function(t){return $(t)?[]:{}},i=function(t,n){var e,i;return P(n)?(f.push(n),a.push(r(t,f.length-1))):n!==Object(n)||"function"==typeof n||n instanceof RegExp||n instanceof Date?a.push(o(t,n)):(i=function(t){return function(r){var e;return e=c(n),l(r,t,e),r.push(e)}},e=function(t){return t.pop()},a.push(i(t)),u(n),a.push(e))},u=function(t){return hn.each(t,i)},u(n),e=function(t){var r,e,i,u,o;for(i=c(n),r=[i],u=0,o=a.length;o>u;u++)(e=a[u])(r,t);return i},ln(t,"combineTemplate",n,t.combineAsArray(f).map(e))},t.retry=function(n){var r,e,i,u,o,s;if(!D(n.source))throw new f("'source' option has to be a function");return s=n.source,u=n.retries||0,i=n.maxRetries||u,r=n.delay||function(){return 0},e=n.isRetryable||function(){return!0},o=function(n){var o,a;return a={source:s,retries:u-1,maxRetries:i,delay:r,isRetryable:e},o=function(){return t.retry(a)},t.later(r(n)).filter(!1).concat(t.once().flatMap(o))},ln(t,"retry",n,s().flatMapError(function(n){return e(n)&&u>0?o({error:n,retriesDone:i-u}):t.once(new a(n))}))},F=0,c=function(){function t(){this.id=++F}return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}(),p=function(t){function n(t,r){n.__super__.constructor.call(this),!r&&D(t)||t instanceof n?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t)}return mn(n,t),n.prototype.isNext=function(){return!0},n.prototype.hasValue=function(){return!0},n.prototype.value=function(){return this.valueF instanceof n?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},n.prototype.fmap=function(t){var n,r;return this.valueInternal?(r=this.valueInternal,this.apply(function(){return t(r)})):(n=this,this.apply(function(){return t(n.value())}))},n.prototype.apply=function(t){return new n(t)},n.prototype.filter=function(t){return t(this.value())},n.prototype.toString=function(){return hn.toString(this.value())},n.prototype.log=function(){return this.value()},n}(c),h=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return mn(n,t),n.prototype.isInitial=function(){return!0
},n.prototype.isNext=function(){return!1},n.prototype.apply=function(t){return new n(t)},n.prototype.toNext=function(){return new p(this)},n}(p),s=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return mn(n,t),n.prototype.isEnd=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<end>"},n}(c),a=function(t){function n(t){this.error=t}return mn(n,t),n.prototype.isError=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<error> "+hn.toString(this.error)},n}(c),V=0,g=function(){function n(t){this.id=++V,ln(t,this),this.initialDesc=this.desc}return n.prototype.subscribe=function(t){return w.wrappedSubscribe(this,t)},n.prototype.subscribeInternal=function(t){return this.dispatcher.subscribe(t)},n.prototype.onValue=function(){var t;return t=Y(arguments),this.subscribe(function(n){return n.hasValue()?t(n.value()):void 0})},n.prototype.onValues=function(t){return this.onValue(function(n){return t.apply(null,n)})},n.prototype.onError=function(){var t;return t=Y(arguments),this.subscribe(function(n){return n.isError()?t(n.error):void 0})},n.prototype.onEnd=function(){var t;return t=Y(arguments),this.subscribe(function(n){return n.isEnd()?t():void 0})},n.prototype.errors=function(){return ln(this,"errors",this.filter(function(){return!1}))},n.prototype.filter=function(){var n,r;return r=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],j(this,r,n,function(n){return ln(this,"filter",n,this.withHandler(function(r){return r.filter(n)?this.push(r):t.more}))})},n.prototype.takeWhile=function(){var n,r;return r=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],j(this,r,n,function(n){return ln(this,"takeWhile",n,this.withHandler(function(r){return r.filter(n)?this.push(r):(this.push(W()),t.noMore)}))})},n.prototype.endOnError=function(){var t,n;return n=arguments[0],t=2<=arguments.length?dn.call(arguments,1):[],null==n&&(n=!0),j(this,n,t,function(t){return ln(this,"endOnError",this.withHandler(function(n){return n.isError()&&t(n.error)?(this.push(n),this.push(W())):this.push(n)}))})},n.prototype.take=function(n){return 0>=n?t.never():ln(this,"take",n,this.withHandler(function(r){return r.hasValue()?(n--,n>0?this.push(r):(0===n&&this.push(r),this.push(W()),t.noMore)):this.push(r)}))},n.prototype.map=function(){var t,n;return n=arguments[0],t=2<=arguments.length?dn.call(arguments,1):[],n instanceof m?n.sampledBy(this,N):j(this,n,t,function(t){return ln(this,"map",t,this.withHandler(function(n){return this.push(n.fmap(t))}))})},n.prototype.mapError=function(){var t;return t=Y(arguments),ln(this,"mapError",t,this.withHandler(function(n){return this.push(n.isError()?X(t(n.error)):n)}))},n.prototype.mapEnd=function(){var n;return n=Y(arguments),ln(this,"mapEnd",n,this.withHandler(function(r){return r.isEnd()?(this.push(X(n(r))),this.push(W()),t.noMore):this.push(r)}))},n.prototype.doAction=function(){var t;return t=Y(arguments),ln(this,"doAction",t,this.withHandler(function(n){return n.hasValue()&&t(n.value()),this.push(n)}))},n.prototype.skip=function(n){return ln(this,"skip",n,this.withHandler(function(r){return r.hasValue()&&n>0?(n--,t.more):this.push(r)}))},n.prototype.skipDuplicates=function(t){return null==t&&(t=function(t,n){return t===n}),ln(this,"skipDuplicates",this.withStateMachine(d,function(n,r){return r.hasValue()?r.isInitial()||n===d||!t(n.get(),r.value())?[new y(r.value()),[r]]:[n,[]]:[n,[r]]}))},n.prototype.skipErrors=function(){return ln(this,"skipErrors",this.withHandler(function(n){return n.isError()?t.more:this.push(n)}))},n.prototype.withStateMachine=function(n,r){var e;return e=n,ln(this,"withStateMachine",n,r,this.withHandler(function(n){var i,u,o,s,a,c,l;for(i=r(e,n),u=i[0],s=i[1],e=u,a=t.more,c=0,l=s.length;l>c;c++)if(o=s[c],a=this.push(o),a===t.noMore)return a;return a}))},n.prototype.scan=function(n,r){var e,i,u;return r=en(r),e=an(n),u=function(n){return function(u){var o,s,a,c;return o=!1,c=G,s=t.more,a=function(){return o?void 0:e.forEach(function(n){return o=!0,s=u(new h(function(){return n})),s===t.noMore?(c(),c=G):void 0})},c=n.dispatcher.subscribe(function(n){var i,c;return n.hasValue()?o&&n.isInitial()?t.more:(n.isInitial()||a(),o=!0,c=e.getOrElse(void 0),i=r(c,n.value()),e=new y(i),u(n.apply(function(){return i}))):(n.isEnd()&&(s=a()),s!==t.noMore?u(n):void 0)}),w.whenDoneWith(i,a),c}}(this),i=new m(H(this,"scan",n,r),u)},n.prototype.fold=function(t,n){return ln(this,"fold",t,n,this.scan(t,n).sampledBy(this.filter(!1).mapEnd().toProperty()))},n.prototype.zip=function(n,r){return null==r&&(r=Array),ln(this,"zip",n,t.zipWith([this,n],r))},n.prototype.diff=function(t,n){return n=en(n),ln(this,"diff",t,n,this.scan([t],function(t,r){return[r,n(t[0],r)]}).filter(function(t){return 2===t.length}).map(function(t){return t[1]}))},n.prototype.flatMap=function(){return q(this,Z(arguments))},n.prototype.flatMapFirst=function(){return q(this,Z(arguments),!0)},n.prototype.flatMapWithConcurrencyLimit=function(){var t,n;return n=arguments[0],t=2<=arguments.length?dn.call(arguments,1):[],ln.apply(null,[this,"flatMapWithConcurrencyLimit",n].concat(dn.call(t),[q(this,Z(t),!1,n)]))},n.prototype.flatMapLatest=function(){var t,n;return t=Z(arguments),n=this.toEventStream(),ln(this,"flatMapLatest",t,n.flatMap(function(r){return Q(t(r)).takeUntil(n)}))},n.prototype.flatMapError=function(n){return ln(this,"flatMapError",n,this.mapError(function(t){return new a(t)}).flatMap(function(r){return r instanceof a?n(r.error):t.once(r)}))},n.prototype.flatMapConcat=function(){return ln.apply(null,[this,"flatMapConcat"].concat(dn.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(dn.call(arguments)))]))},n.prototype.bufferingThrottle=function(n){return ln(this,"bufferingThrottle",n,this.flatMapConcat(function(r){return t.once(r).concat(t.later(n).filter(!1))}))},n.prototype.not=function(){return ln(this,"not",this.map(function(t){return!t}))},n.prototype.log=function(){var t;return t=1<=arguments.length?dn.call(arguments,0):[],this.subscribe(function(n){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,dn.call(t).concat([n.log()])):void 0}),this},n.prototype.slidingWindow=function(t,n){return null==n&&(n=0),ln(this,"slidingWindow",t,n,this.scan([],function(n,r){return n.concat([r]).slice(-t)}).filter(function(t){return t.length>=n}))},n.prototype.combine=function(n,r){var e;return e=en(r),ln(this,"combine",n,r,t.combineAsArray(this,n).map(function(t){return e(t[0],t[1])}))},n.prototype.decode=function(n){return ln(this,"decode",n,this.combine(t.combineTemplate(n),function(t,n){return n[t]}))},n.prototype.awaiting=function(n){return ln(this,"awaiting",n,t.groupSimultaneous(this,n).map(function(t){var n,r;return n=t[0],r=t[1],0===r.length}).toProperty(!1).skipDuplicates())},n.prototype.name=function(t){return this._name=t,this},n.prototype.withDescription=function(){return H.apply(null,arguments).apply(this)},n.prototype.toString=function(){return this._name?this._name:this.desc.toString()},n.prototype.internalDeps=function(){return this.initialDesc.deps()},n}(),g.prototype.reduce=g.prototype.fold,g.prototype.assign=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,q=function(n,r,i,u){var o,s,a;return a=[n],o=[],s=new l(H(n,"flatMap"+(i?"First":""),r),function(s){var a,c,l,f,p;return l=new e,f=[],p=function(n){var e;return e=Q(r(n.value())),o.push(e),l.add(function(n,r){return e.dispatcher.subscribe(function(i){var u;return i.isEnd()?(hn.remove(e,o),c(),a(r),t.noMore):(i instanceof h&&(i=i.toNext()),u=s(i),u===t.noMore&&n(),u)})})},c=function(){var t;return t=f.shift(),t?p(t):void 0},a=function(t){return t(),l.empty()?s(W()):void 0},l.add(function(r,e){return n.dispatcher.subscribe(function(n){return n.isEnd()?a(e):n.isError()?s(n):i&&l.count()>1?t.more:l.unsubscribed?t.noMore:u&&l.count()>u?f.push(n):p(n)})}),l.unsubscribe}),s.internalDeps=function(){return o.length?a.concat(o):a},s},l=function(n){function r(t,n,e){D(t)&&(e=n,n=t,t=[]),r.__super__.constructor.call(this,t),k(n),this.dispatcher=new o(n,e),nn(this)}return mn(r,n),r.prototype.delay=function(n){return ln(this,"delay",n,this.flatMap(function(r){return t.later(n,r)}))},r.prototype.debounce=function(n){return ln(this,"debounce",n,this.flatMapLatest(function(r){return t.later(n,r)}))},r.prototype.debounceImmediate=function(n){return ln(this,"debounceImmediate",n,this.flatMapFirst(function(r){return t.once(r).concat(t.later(n).filter(!1))}))},r.prototype.throttle=function(t){return ln(this,"throttle",t,this.bufferWithTime(t).map(function(t){return t[t.length-1]}))},r.prototype.bufferWithTime=function(t){return ln(this,"bufferWithTime",t,this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},r.prototype.bufferWithCount=function(t){return ln(this,"bufferWithCount",t,this.bufferWithTimeOrCount(void 0,t))},r.prototype.bufferWithTimeOrCount=function(t,n){var r;return r=function(r){return r.values.length===n?r.flush():void 0!==t?r.schedule():void 0},ln(this,"bufferWithTimeOrCount",t,n,this.buffer(t,r,r))},r.prototype.buffer=function(n,r,e){var i,u,o;return null==r&&(r=G),null==e&&(e=G),i={scheduled:!1,end:void 0,values:[],flush:function(){var n;if(this.scheduled=!1,this.values.length>0){if(n=this.push(X(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(n!==t.noMore)return e(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:(this.scheduled=!0,n(function(t){return function(){return t.flush()}}(this)))}},o=t.more,D(n)||(u=n,n=function(n){return t.scheduler.setTimeout(n,u)}),ln(this,"buffer",this.withHandler(function(t){return i.push=function(t){return function(n){return t.push(n)}}(this),t.isError()?o=this.push(t):t.isEnd()?(i.end=t,i.scheduled||i.flush()):(i.values.push(t.value()),r(i)),o}))},r.prototype.merge=function(n){var r;return A(n),r=this,ln(r,"merge",n,t.mergeAll(this,n))},r.prototype.toProperty=function(n){var r,e;return e=0===arguments.length?d:an(function(){return n}),r=this.dispatcher,new m(H(this,"toProperty",n),function(n){var i,u,o,s;return i=!1,s=G,u=t.more,o=function(){return i?void 0:e.forEach(function(r){return i=!0,u=n(new h(r)),u===t.noMore?(s(),s=G):void 0})},s=r.subscribe(function(r){return r.hasValue()?i&&r.isInitial()?t.more:(r.isInitial()||o(),i=!0,e=new y(r),n(r)):(r.isEnd()&&(u=o()),u!==t.noMore?n(r):void 0)}),o(),s})},r.prototype.toEventStream=function(){return this},r.prototype.sampledBy=function(t,n){return ln(this,"sampledBy",t,n,this.toProperty().sampledBy(t,n))},r.prototype.concat=function(t){var n;return n=this,new r(H(n,"concat",t),function(r){var e,i;return i=G,e=n.dispatcher.subscribe(function(n){return n.isEnd()?i=t.dispatcher.subscribe(r):r(n)}),function(){return e(),i()}})},r.prototype.takeUntil=function(n){var r;return r={},ln(this,"takeUntil",n,t.groupSimultaneous(this.mapEnd(r),n.skipErrors()).withHandler(function(e){var i,u,o,s,a,c;if(e.hasValue()){if(c=e.value(),i=c[0],n=c[1],n.length)return this.push(W());for(u=t.more,s=0,a=i.length;a>s;s++)o=i[s],u=this.push(o===r?W():X(o));return u}return this.push(e)}))},r.prototype.skipUntil=function(t){var n;return n=t.take(1).map(!0).toProperty(!1),ln(this,"skipUntil",t,this.filter(n))},r.prototype.skipWhile=function(){var n,r,e;return r=arguments[0],n=2<=arguments.length?dn.call(arguments,1):[],e=!1,j(this,r,n,function(n){return ln(this,"skipWhile",n,this.withHandler(function(r){return!e&&r.hasValue()&&n(r.value())?t.more:(r.hasValue()&&(e=!0),this.push(r))}))})},r.prototype.holdWhen=function(n){var r,e,i;return i=n.startWith(!1),e=i.filter(function(t){return!t}),r=i.filter(hn.id),ln(this,"holdWhen",n,this.filter(!1).merge(i.flatMapConcat(function(n){return function(i){return i?n.scan([],function(t,n){return t.concat(n)}).sampledBy(e).take(1).flatMap(t.fromArray):n.takeUntil(r)}}(this))))},r.prototype.startWith=function(n){return ln(this,"startWith",n,t.once(n).concat(this))},r.prototype.withHandler=function(t){return new r(H(this,"withHandler",t),this.dispatcher.subscribe,t)},r}(g),m=function(n){function r(t,n,e){D(t)&&(e=n,n=t,t=[]),r.__super__.constructor.call(this,t),k(n),this.dispatcher=new v(this,n,e),nn(this)}return mn(r,n),r.prototype.sampledBy=function(n,e){var i,u,o,s,a;return null!=e?e=en(e):(i=!0,e=function(t){return t.value()}),a=new b(this,!1,i),o=new b(n,!0,i),s=t.when([a,o],e),u=n instanceof r?s.toProperty():s,ln(this,"sampledBy",n,e,u)},r.prototype.sample=function(n){return ln(this,"sample",n,this.sampledBy(t.interval(n,{})))},r.prototype.changes=function(){return new l(H(this,"changes"),function(t){return function(n){return t.dispatcher.subscribe(function(t){return t.isInitial()?void 0:n(t)})}}(this))},r.prototype.withHandler=function(t){return new r(H(this,"withHandler",t),this.dispatcher.subscribe,t)},r.prototype.toProperty=function(){return x(arguments),this},r.prototype.toEventStream=function(){return new l(H(this,"toEventStream"),function(t){return function(n){return t.dispatcher.subscribe(function(t){return t.isInitial()&&(t=t.toNext()),n(t)})}}(this))},r.prototype.and=function(t){return ln(this,"and",t,this.combine(t,function(t,n){return t&&n}))},r.prototype.or=function(t){return ln(this,"or",t,this.combine(t,function(t,n){return t||n}))},r.prototype.delay=function(t){return this.delayChanges("delay",t,function(n){return n.delay(t)})},r.prototype.debounce=function(t){return this.delayChanges("debounce",t,function(n){return n.debounce(t)})},r.prototype.throttle=function(t){return this.delayChanges("throttle",t,function(n){return n.throttle(t)})},r.prototype.delayChanges=function(){var t,n,r;return t=2<=arguments.length?dn.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],ln.apply(null,[this].concat(dn.call(t),[E(this,n(this.changes()))]))},r.prototype.takeUntil=function(t){var n;return n=this.changes().takeUntil(t),ln(this,"takeUntil",t,E(this,n))},r.prototype.startWith=function(t){return ln(this,"startWith",t,this.scan(t,function(t,n){return n}))},r.prototype.bufferingThrottle=function(){var t;return(t=r.__super__.bufferingThrottle.apply(this,arguments)).bufferingThrottle.apply(t,arguments).toProperty()},r}(g),j=function(t,n,r,e){var i;return n instanceof m?(i=n.sampledBy(t,function(t,n){return[t,n]}),e.call(i,function(t){var n,r;return n=t[0],r=t[1],n}).map(function(t){var n,r;return n=t[0],r=t[1]})):(n=z(n,r),e.call(t,n))},E=function(n,r){var e;return e=new l(H(n,"justInitValue"),function(r){var i,u;return u=void 0,i=n.dispatcher.subscribe(function(n){return n.isEnd()||(u=n),t.noMore}),w.whenDoneWith(e,function(){return null!=u&&r(u),r(W())}),i}),e.concat(r).toProperty()},o=function(){function n(t,n){this._subscribe=t,this._handleEvent=n,this.subscribe=vn(this.subscribe,this),this.handleEvent=vn(this.handleEvent,this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0}return n.prototype.hasSubscribers=function(){return this.subscriptions.length>0},n.prototype.removeSub=function(t){return this.subscriptions=hn.without(t,this.subscriptions)},n.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),w.inTransaction(t,this,this.pushIt,[t])},n.prototype.pushToSubscriptions=function(n){var r,e,i,u,o;try{for(i=this.subscriptions,u=0,o=i.length;o>u;u++)e=i[u],r=e.sink(n),(r===t.noMore||n.isEnd())&&this.removeSub(e);return!0}catch(s){return this.queue=[],!1}},n.prototype.pushIt=function(n){if(this.pushing)return this.queue.push(n),t.more;if(n!==this.prevError){for(n.isError()&&(this.prevError=n),this.pushing=!0,this.pushToSubscriptions(n),this.pushing=!1;this.queue.length;)n=this.queue.shift(),this.push(n);return this.hasSubscribers()?t.more:(this.unsubscribeFromSource(),t.noMore)}},n.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},n.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},n.prototype.subscribe=function(t){var n;return this.ended?(t(W()),G):(k(t),n={sink:t},this.subscriptions.push(n),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),k(this.unsubSrc)),function(t){return function(){return t.removeSub(n),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},n}(),v=function(n){function r(t,n,e){this.property=t,this.subscribe=vn(this.subscribe,this),r.__super__.constructor.call(this,n,e),this.current=d,this.currentValueRootId=void 0,this.propertyEnded=!1}return mn(r,n),r.prototype.push=function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new y(t),this.currentValueRootId=w.currentEventId()),r.__super__.push.call(this,t)},r.prototype.maybeSubSource=function(n,r){return r===t.noMore?G:this.propertyEnded?(n(W()),G):o.prototype.subscribe.call(this,n)},r.prototype.subscribe=function(n){var r,e,i,u;return e=!1,i=t.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(r=w.currentEventId(),u=this.currentValueRootId,!this.propertyEnded&&u&&r&&r!==u?(w.whenDoneWith(this.property,function(t){return function(){return t.currentValueRootId===u?n(C(t.current.get().value())):void 0}}(this)),this.maybeSubSource(n,i)):(w.inTransaction(void 0,this,function(){return i=function(){try{return n(C(this.current.get().value()))}catch(r){return t.more}}.call(this)},[]),this.maybeSubSource(n,i))):this.maybeSubSource(n,i)},r}(o),r=function(n){function r(){this.guardedSink=vn(this.guardedSink,this),this.subscribeAll=vn(this.subscribeAll,this),this.unsubAll=vn(this.unsubAll,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,r.__super__.constructor.call(this,H(t,"Bus"),this.subscribeAll)}return mn(r,n),r.prototype.unsubAll=function(){var t,n,r,e;for(e=this.subscriptions,n=0,r=e.length;r>n;n++)t=e[n],"function"==typeof t.unsub&&t.unsub();return void 0},r.prototype.subscribeAll=function(t){var n,r,e,i;for(this.sink=t,i=M(this.subscriptions),r=0,e=i.length;e>r;r++)n=i[r],this.subscribeInput(n);return this.unsubAll},r.prototype.guardedSink=function(n){return function(r){return function(e){return e.isEnd()?(r.unsubscribeInput(n),t.noMore):r.sink(e)}}(this)},r.prototype.subscribeInput=function(t){return t.unsub=t.input.dispatcher.subscribe(this.guardedSink(t.input))},r.prototype.unsubscribeInput=function(t){var n,r,e,i,u;for(u=this.subscriptions,n=e=0,i=u.length;i>e;n=++e)if(r=u[n],r.input===t)return"function"==typeof r.unsub&&r.unsub(),void this.subscriptions.splice(n,1)},r.prototype.plug=function(t){var n;if(!this.ended)return n={input:t},this.subscriptions.push(n),null!=this.sink&&this.subscribeInput(n),function(n){return function(){return n.unsubscribeInput(t)}}(this)},r.prototype.end=function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(W()):void 0},r.prototype.push=function(t){return"function"==typeof this.sink?this.sink(X(t)):void 0},r.prototype.error=function(t){return"function"==typeof this.sink?this.sink(new a(t)):void 0},r}(l),b=function(){function t(t,n,r){this.obs=t,this.sync=n,this.lazy=null!=r?r:!1,this.queue=[]}return t.prototype.subscribe=function(t){return this.obs.dispatcher.subscribe(t)},t.prototype.toString=function(){return this.obs.toString()},t.prototype.markEnded=function(){return this.ended=!0},t.prototype.consume=function(){return this.lazy?{value:hn.always(this.queue[0])}:this.queue[0]},t.prototype.push=function(t){return this.queue=[t]},t.prototype.mayHave=function(){return!0},t.prototype.hasAtLeast=function(){return this.queue.length},t.prototype.flatten=!0,t}(),i=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return mn(n,t),n.prototype.consume=function(){return this.queue.shift()},n.prototype.push=function(t){return this.queue.push(t)},n.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},n.prototype.hasAtLeast=function(t){return this.queue.length>=t},n.prototype.flatten=!1,n}(b),n=function(t){function n(t){n.__super__.constructor.call(this,t,!0)}return mn(n,t),n.prototype.consume=function(){var t;return t=this.queue,this.queue=[],{value:function(){return t}}},n.prototype.push=function(t){return this.queue.push(t.value())},n.prototype.hasAtLeast=function(){return!0},n}(b),b.isTrigger=function(t){return t instanceof b?t.sync:t instanceof l},b.fromObservable=function(t){return t instanceof b?t:t instanceof m?new b(t,!1):new i(t,!0)},H=function(){var t,n,r;return n=arguments[0],r=arguments[1],t=3<=arguments.length?dn.call(arguments,2):[],(n||r)instanceof u?n||r:new u(n,r,t)},B=function(t){return $(t)?hn.flatMap(B,t):P(t)?[t]:t instanceof b?[t.obs]:[]},u=function(){function t(t,n,r){this.context=t,this.method=n,this.args=r,this.cached=void 0}return t.prototype.deps=function(){return this.cached||(this.cached=B([this.context].concat(this.args)))},t.prototype.apply=function(t){return t.desc=this,t},t.prototype.toString=function(){return hn.toString(this.context)+"."+hn.toString(this.method)+"("+hn.map(hn.toString,this.args)+")"},t}(),ln=function(){var t,n,r;return t=2<=arguments.length?dn.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],H.apply(null,t).apply(n)},t.when=function(){var n,r,e,i,u,o,s,a,c,f,h,p,d,g,m,v,y,E,_,A;if(0===arguments.length)return t.never();for(u=arguments.length,m="when: expecting arguments in the form (Observable+,function)+",S(m,u%2===0),d=[],c=[],r=0,f=[];u>r;){for(f[r]=arguments[r],f[r+1]=arguments[r+1],a=hn.toArray(arguments[r]),n=arguments[r+1],s={f:D(n)?n:function(){return n},ixs:[]},g=!1,v=0,E=a.length;E>v;v++){for(p=a[v],e=hn.indexOf(d,p),g||(g=b.isTrigger(p)),0>e&&(d.push(p),e=d.length-1),A=s.ixs,y=0,_=A.length;_>y;y++)i=A[y],i.index===e&&i.count++;s.ixs.push({index:e,count:1})}S("At least one EventStream required",g||!a.length),a.length>0&&c.push(s),r+=2}return d.length?(d=hn.map(b.fromObservable,d),o=hn.any(d,function(t){return t.flatten})&&I(hn.map(function(t){return t.obs},d)),h=new l(H.apply(null,[t,"when"].concat(dn.call(f))),function(n){var e,i,u,s,a,l,f;return f=[],u=!1,s=function(t){var n,e,i;for(i=t.ixs,n=0,e=i.length;e>n;n++)if(r=i[n],!d[r.index].hasAtLeast(r.count))return!1;return!0},i=function(t){return!t.sync||t.ended},e=function(t){var n,e,i;for(i=t.ixs,n=0,e=i.length;e>n;n++)if(r=i[n],!d[r.index].mayHave(r.count))return!0},a=function(t){return!t.source.flatten},l=function(l){return function(p){var g,m,v;return m=function(){return w.whenDoneWith(h,g)},v=function(){var e,i,u,o,l,h;if(!(f.length>0))return t.more;for(u=t.more,o=f.pop(),l=0,h=c.length;h>l;l++)if(i=c[l],s(i))return e=function(){var t,n,e,u;for(e=i.ixs,u=[],t=0,n=e.length;n>t;t++)r=e[t],u.push(d[r.index].consume());return u}(),u=n(o.e.apply(function(){var t,n;return n=function(){var n,r,i;for(i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(t.value());return i}(),i.f.apply(i,n)})),f.length&&(f=hn.filter(a,f)),u===t.noMore?u:v()},g=function(){var r;return r=v(),u&&(u=!1,(hn.all(d,i)||hn.all(c,e))&&(r=t.noMore,n(W()))),r===t.noMore&&p(),r},l.subscribe(function(r){var e;return r.isEnd()?(u=!0,l.markEnded(),m()):r.isError()?e=n(r):(l.push(r),l.sync&&(f.push({source:l,e:r}),o||w.hasWaiters()?m():g())),e===t.noMore&&p(),e||t.more})}},O.apply(null,function(){var t,n,r;for(r=[],t=0,n=d.length;n>t;t++)p=d[t],r.push(l(p));return r}())})):t.never()},I=function(t,n){var r;return null==n&&(n=[]),r=function(t){var e;return hn.contains(n,t)?!0:(e=t.internalDeps(),e.length?(n.push(t),hn.any(e,r)):(n.push(t),!1))},hn.any(t,r)},t.update=function(){var n,r,e,i;for(r=arguments[0],i=2<=arguments.length?dn.call(arguments,1):[],e=function(t){return function(){var n;return n=1<=arguments.length?dn.call(arguments,0):[],function(r){return t.apply(null,[r].concat(n))}}},n=i.length-1;n>0;)i[n]instanceof Function||(i[n]=function(t){return function(){return t}}(i[n])),i[n]=e(i[n]),n-=2;return ln.apply(null,[t,"update",r].concat(dn.call(i),[t.when.apply(t,i).scan(r,function(t,n){return n(t)})]))},O=function(){var t;return t=1<=arguments.length?dn.call(arguments,0):[],new e(t).unsubscribe},e=function(){function t(t){var n,r,e;for(null==t&&(t=[]),this.unsubscribe=vn(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],r=0,e=t.length;e>r;r++)n=t[r],this.add(n)}return t.prototype.add=function(t){var n,r,e;if(!this.unsubscribed)return n=!1,r=G,this.starting.push(t),e=function(e){return function(){return e.unsubscribed?void 0:(n=!0,e.remove(r),hn.remove(t,e.starting))}}(this),r=t(this.unsubscribe,e),this.unsubscribed||n||this.subscriptions.push(r),hn.remove(t,this.starting),r},t.prototype.remove=function(t){return this.unsubscribed?void 0:void 0!==hn.remove(t,this.subscriptions)?t():void 0},t.prototype.unsubscribe=function(){var t,n,r,e;if(!this.unsubscribed){for(this.unsubscribed=!0,e=this.subscriptions,n=0,r=e.length;r>n;n++)(t=e[n])();return this.subscriptions=[],this.starting=[]}},t.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},t.prototype.empty=function(){return 0===this.count()},t}(),t.CompositeUnsubscribe=e,y=function(){function t(t){this.value=t}return t.prototype.getOrElse=function(){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(n){return n(this.value)?new t(this.value):d},t.prototype.map=function(n){return new t(n(this.value))},t.prototype.forEach=function(t){return t(this.value)},t.prototype.isDefined=!0,t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),d={getOrElse:function(t){return t},filter:function(){return d},map:function(){return d},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},w=function(){var n,r,e,i,u,o,s,a,c,l,f,h,p,d;return l=void 0,f=[],h={},r=[],e=0,n=function(t){return l?r.push(t):t()},p=function(t,n){var r;return l?(r=h[t.id],null==r?(r=h[t.id]=[n],f.push(t)):r.push(n)):n()},u=function(){for(;f.length>0;)s(0);return void 0},s=function(t){var n,r,e,i,u,s;for(r=f[t],e=r.id,i=h[e],f.splice(t,1),delete h[e],o(r),u=0,s=i.length;s>u;u++)(n=i[u])();return void 0},o=function(t){var n,r,e,i,u;for(r=t.internalDeps(),i=0,u=r.length;u>i;i++)n=r[i],o(n),h[n.id]&&(e=hn.indexOf(f,n),s(e));return void 0},c=function(t,n,i,o){var s,a;if(l)return i.apply(n,o);for(l=t,a=i.apply(n,o),u(),l=void 0;e<r.length;)s=r[e],e++,s();return e=0,r=[],a},i=function(){return l?l.id:void 0},d=function(r,e){var i,u,o;return o=!1,i=function(){},u=function(){return o=!0,i()},i=r.dispatcher.subscribe(function(r){return n(function(){var n;return o||(n=e(r),n!==t.noMore)?void 0:u()})}),u},a=function(){return f.length>0},{whenDoneWith:p,hasWaiters:a,inTransaction:c,currentEventId:i,wrappedSubscribe:d}}(),t.EventStream=l,t.Property=m,t.Observable=g,t.Bus=r,t.Initial=h,t.Next=p,t.End=s,t.Error=a,G=function(){},R=function(t,n){return n},N=function(t){return t},C=function(t){return new h(t,!0)},X=function(t){return new p(t,!0)},W=function(){return new s},un=function(t){return t instanceof c?t:X(t)},M=function(t){return t.slice(0)},S=function(t,n){if(!n)throw new f(t)},A=function(t){if(!(t instanceof l))throw new f("not an EventStream : "+t)},k=function(t){return S("not a function : "+t,D(t))},D=function(t){return"function"==typeof t},$=function(t){return t instanceof Array},P=function(t){return t instanceof g},_=function(t){if(!$(t))throw new f("not an array : "+t)},x=function(t){return S("no arguments supported",0===t.length)},T=function(t){if("string"!=typeof t)throw new f("not a string : "+t)},J=function(t,n){return function(){var r;return r=1<=arguments.length?dn.call(arguments,0):[],t.apply(null,n.concat(r))}},Z=function(t){return 1===t.length&&P(t[0])?hn.always(t[0]):Y(t)},Y=function(t){return t=Array.prototype.slice.call(t),K.apply(null,t)},K=fn(function(){var t,n;return n=arguments[0],t=2<=arguments.length?dn.call(arguments,1):[],D(n)?t.length?J(n,t):n:L(n)?on(n,t):hn.always(n)}),z=function(t,n){return K.apply(null,[t].concat(dn.call(n)))},Q=function(n){return P(n)?n:t.once(n)},L=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},t.isFieldKey=L,on=function(t,n){var r,e;return e=t.slice(1).split("."),r=hn.map(cn(n),e),function(n){var e,i;for(e=0,i=r.length;i>e;e++)t=r[e],n=t(n);return n}},cn=function(t){return function(n){return function(r){var e;return null==r?void 0:(e=r[n],D(e)?e.apply(r,t):e)}}},sn=function(t){return t.slice(1)},en=function(t){var n;return D(t)?t:L(t)?(n=sn(t),function(t,r){return t[n](r)}):S("not a function or a field key: "+t,!1)},an=function(t){return t instanceof y||t===d?t:new y(t)},hn={indexOf:Array.prototype.indexOf?function(t,n){return t.indexOf(n)}:function(t,n){var r,e,i,u;for(r=i=0,u=t.length;u>i;r=++i)if(e=t[r],n===e)return r;return-1},indexWhere:function(t,n){var r,e,i,u;for(r=i=0,u=t.length;u>i;r=++i)if(e=t[r],n(e))return r;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(n){return!t(n)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,n){var r,e,i,u;for(r=[],i=0,u=n.length;u>i;i++)e=n[i],t(e)&&r.push(e);return r},map:function(t,n){var r,e,i,u;for(u=[],e=0,i=n.length;i>e;e++)r=n[e],u.push(t(r));return u},each:function(t,n){var r,e;for(r in t)e=t[r],n(r,e);return void 0},toArray:function(t){return $(t)?t:[t]},contains:function(t,n){return-1!==hn.indexOf(t,n)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t,n){var r,e,i;for(null==n&&(n=hn.id),e=0,i=t.length;i>e;e++)if(r=t[e],!n(r))return!1;return!0},any:function(t,n){var r,e,i;for(null==n&&(n=hn.id),e=0,i=t.length;i>e;e++)if(r=t[e],n(r))return!0;return!1},without:function(t,n){return hn.filter(function(n){return n!==t},n)},remove:function(t,n){var r;return r=hn.indexOf(n,t),r>=0?n.splice(r,1):void 0},fold:function(t,n,r){var e,i,u;for(i=0,u=t.length;u>i;i++)e=t[i],n=r(n,e);return n},flatMap:function(t,n){return hn.fold(n,[],function(n,r){return n.concat(t(r))})},cached:function(t){var n;return n=d,function(){return n===d&&(n=t(),t=void 0),n}},toString:function(t){var n,r,e,i;try{return tn++,null==t?"undefined":D(t)?"function":$(t)?tn>5?"[..]":"["+hn.map(hn.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?tn>5?"{..}":(r=function(){var r;r=[];for(e in t)gn.call(t,e)&&(i=function(){try{return t[e]}catch(r){return n=r}}(),r.push(hn.toString(e)+":"+hn.toString(i)));return r}(),"{"+r+"}"):t}finally{tn--}}},tn=0,t._=hn,t.scheduler={setTimeout:function(t,n){return setTimeout(t,n)},setInterval:function(t,n){return setInterval(t,n)},clearInterval:function(t){return clearInterval(t)},now:function(){return(new Date).getTime()}},"undefined"!=typeof define&&null!==define&&null!=define.amd?(define([],function(){return t}),this.Bacon=t):"undefined"!=typeof module&&null!==module&&null!=module.exports?(module.exports=t,t.Bacon=t):this.Bacon=t}.call(this),function(){var t,n,r,e,i,u,o,s,a;$("header").headroom().find("a").tipsy({gravity:"n",fade:!0}),r=["pikachu","giant","dhh","posts/listen","posts/frp"],u=$(".notice"),n=$(".main-image"),o=$("#main .welcome, #main .post"),t=function(t){var n;return t[0]===(n=t[1])&&n===t[2]},a=$(".shuffle").asEventStream("click").doAction(function(t){return t.preventDefault()}),i=a.debounceImmediate(1e3).map(function(){return _.sample(r)}),e=i.slidingWindow(3,3).filter(t),s=$(document).asEventStream("scroll").filter(function(){return $(".welcome").length>0}).map(function(){return _.min(o,function(t){return Math.abs(t.getBoundingClientRect().top)})}).map(function(t){return $(t).data("color")}),e.doAction(function(){return u.text("Same image 3 times in a row, that must be really annoying for you"),u.css("opacity",1)}).delay(3e3).onValue(function(){return u.css("opacity",0)}),i.doAction(function(){return n.css("opacity",0)}).delay(500).onValue(function(t){return n.attr("src","/public/images/"+t+".svg").css("opacity",1)}),s.onValue(function(t){return $("body").removeClass().addClass(t)}),$("#podcast").length>0&&new Audio("/public/audio/bikeshed-1.mp3").play()}.call(this);